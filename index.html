<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Student Registration</title>
  <style>
    body{font-family:Arial,Helvetica,sans-serif;background:#f3f6fb;display:flex;align-items:center;justify-content:center;height:100vh;margin:0}
    .card{background:#fff;padding:24px;border-radius:10px;box-shadow:0 6px 18px rgba(20,40,80,0.08);width:360px}
    .card h2{margin:0 0 12px;font-size:18px}
    .row{margin-bottom:8px}
    input,select{width:100%;padding:10px;border:1px solid #ddd;border-radius:6px;box-sizing:border-box}
    button{width:100%;padding:10px;background:#0066cc;border:none;color:#fff;border-radius:6px;cursor:pointer;margin-top:10px}
    button:hover{background:#0052a3}
    .small{font-size:12px;color:#666;margin-top:8px}
  </style>
</head>
<body>
  <div class="card">
    <h2>Student Registration</h2>
    <form id="regForm">
      <div class="row"><input id="pin" placeholder="PIN No" required /></div>
      <div class="row"><input id="fullName" placeholder="Full Name" required /></div>
      <div class="row"><input id="email" type="email" placeholder="Email" required /></div>
      <div class="row"><input id="phone" placeholder="Phone" required /></div>
      <div class="row"><input id="college" placeholder="College" required /></div>
      <div class="row"><input id="branch" placeholder="Branch" required /></div>
      <div class="row"><input id="year" placeholder="Year" required /></div>
      <div class="row"><input id="password" type="password" placeholder="Password" required /></div>

      <label style="display:block;margin:8px 0;font-size:13px">
        <input id="hashToggle" type="checkbox" checked /> Hash password (SHA-256) before sending
      </label>

      <button type="submit">Submit</button>
      <div class="small">Note: This demo stores data in Google Sheets. Do not use real passwords.</div>
    </form>
  </div>

  <script>
    // <-- Paste your Web App URL here (the /exec URL you provided) -->
    const scriptURL = "https://script.google.com/macros/s/AKfycbwogsDJCW7hsCcCI2Jb82hwQelNrF5MfDXPyqOiqCauAF8efOOQVuj__ujBbx-Fgy1nAA/exec";

    // Utility: compute SHA-256 hash (returns hex string)
    async function sha256Hex(msg) {
      const enc = new TextEncoder();
      const data = enc.encode(msg);
      const hashBuffer = await crypto.subtle.digest('SHA-256', data);
      const hashArray = Array.from(new Uint8Array(hashBuffer));
      return hashArray.map(b => b.toString(16).padStart(2,'0')).join('');
    }

    document.getElementById('regForm').addEventListener('submit', async function(e) {
      e.preventDefault();

      // Collect values
      const payload = {
        pin: document.getElementById('pin').value.trim(),
        fullName: document.getElementById('fullName').value.trim(),
        email: document.getElementById('email').value.trim(),
        phone: document.getElementById('phone').value.trim(),
        college: document.getElementById('college').value.trim(),
        branch: document.getElementById('branch').value.trim(),
        year: document.getElementById('year').value.trim(),
        password: document.getElementById('password').value
      };

      // Client-side validation (minimal)
      for (const k of ['pin','fullName','email','phone','college','branch','year','password']) {
        if (!payload[k]) { alert('Please fill: ' + k); return; }
      }

      // Hash password if checkbox checked
      const doHash = document.getElementById('hashToggle').checked;
      if (doHash) {
        try {
          payload.password = await sha256Hex(payload.password);
        } catch (err) {
          alert('Hash error: ' + err);
          return;
        }
      }

      // Send to Apps Script
      try {
        const res = await fetch(scriptURL, {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify(payload)
        });
        const text = await res.text();
        alert(text);
        // Optionally clear form on success:
        if (res.ok) document.getElementById('regForm').reset();
      } catch (err) {
        alert('Network error: ' + err);
      }
    });
  </script>
</body>
</html>
